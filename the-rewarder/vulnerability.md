# The Rewarder - Vulnerability Analysis

## Vulnerability Description
The Rewarder vulnerability demonstrates a critical flaw in reward distribution systems that rely on balance snapshots at specific moments without considering the duration of asset holding.

## Root Cause
The core issue is that the `TheRewarderPool` contract distributes rewards based on a user's balance at the moment of distribution, without verifying how long they've held those assets. This enables flash loan attacks where an attacker can:

1. Take a flash loan of a large amount of tokens
2. Deposit them into the reward pool during a reward snapshot
3. Claim rewards proportional to this artificially large balance
4. Withdraw the original tokens and repay the flash loan
5. Retain the rewards with zero capital commitment

## Technical Details
The vulnerability specifically exists in the `distributeRewards()` function which fails to implement proper checkpoints or time-weighted position accounting. Instead, it uses the current balances from the accounting token to determine reward distribution, making it vulnerable to momentary balance manipulation.

## Attack Vector
Flash loans provide the perfect attack mechanism since they allow an attacker to temporarily control a large amount of capital (potentially the entire pool) for a single transaction, maximizing the reward extraction with no actual investment.