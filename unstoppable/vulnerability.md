# Analyse de la vulnérabilité

## Contexte
Le protocole UnstoppableLender permet des prêts flash de tokens, utilisant un mécanisme de suivi de solde interne versus le solde réel.

## Vecteur d'attaque
La fonction `flashLoan()` contient une assertion critique:

```solidity
assert(poolBalance == balanceBefore);
```

Cette assertion impose que le solde interne (`poolBalance`) soit toujours égal au solde réel. Cependant, il existe un moyen de modifier le solde réel sans mettre à jour `poolBalance`.

## Détails techniques
1. Le contrat met à jour `poolBalance` uniquement via la fonction `depositTokens()`
2. Rien n'empêche un utilisateur d'envoyer des tokens directement au contrat via `transfer()`
3. Cette incohérence entre le solde suivi et le solde réel brise l'invariant

## Diagramme du flux d'attaque
[Voir diagramme](./diagrams/unstoppable-flow.png)